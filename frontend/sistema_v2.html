<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description"
        content="Sistema de Captura y Gesti√≥n de Datos Multimodales para Lengua de Se√±as Ecuatoriana" />
    <title>Universidad de Guayaquil | Sistema de Captura LSE</title>

    <!-- Bootstrap CSS + Icons + Fuente -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />

    <!--CSS -->
    <link rel="stylesheet" href="css/style.css" />
</head>

<body class="d-flex flex-column min-vh-100">
    <!-- Toaster -->
    <div id="toastContainer" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index:1080;"></div>

    <!-- Header -->
    <header class="header-gradient text-white shadow-lg position-relative">
        <div class="container position-relative py-4">
            <!-- Cerrar sesi√≥n -->
            <div class="position-top-end">
                <button id="cerrarSesionBtn" class="btn btn-outline-light btn-sm rounded-pill px-3 shadow-sm"
                    type="button" aria-label="Cerrar sesi√≥n">
                    <i class="bi bi-box-arrow-right me-1" aria-hidden="true"></i> Cerrar Sesi√≥n
                </button>
            </div>

            <!-- Logo -->
            <div class="d-flex justify-content-center align-items-center gap-5 flex-wrap mt-4 mb-4">
                <img src="img/logo2.png" alt="Logo Universidad de Guayaquil" class="header-logo img-fluid"
                    loading="lazy" decoding="async" />
            </div>

            <!-- T√≠tulos -->
            <div class="text-center">
                <h1 class="system-title mb-1">Universidad de Guayaquil</h1>
                <p class="system-subtitle mb-1">Sistema de Captura y Gesti√≥n de Datos Multimodales</p>
                <span class="badge badge-lse mt-2" aria-label="Lengua de Se√±as Ecuatoriana">Lengua de Se√±as Ecuatoriana
                    (LSE)</span>
                <p class="project-subtitle mt-2 mb-0">Proyecto de Investigaci√≥n</p>
            </div>
        </div>
    </header>

    <!-- Main -->
    <main id="contenido" class="flex-grow-1">
        <div class="container my-5">
            <!-- Descripci√≥n -->
            <section class="descripcion text-center rounded-4 shadow-sm mx-auto">
                <div class="description-icon mb-3">
                    <i class="bi bi-info-circle-fill text-primary fs-2" aria-hidden="true"></i>
                </div>
                <p class="lead mb-0">
                    Plataforma acad√©mica para capturar, etiquetar y almacenar secuencias de video con puntos de
                    referencia de manos (landmarks) para la traducci√≥n de la Lengua de Se√±as Ecuatoriana.
                </p>
            </section>

            <!-- Opciones -->
            <section class="seccion-opciones my-4">
                <h3 class="text-center fw-bold mb-3">Opciones principales</h3>
                <div class="d-flex flex-wrap justify-content-center gap-3 btn-container">
                    <button class="btn btn-action btn-lg btn-outline-primary rounded-pill px-4 py-2" type="button"
                        onclick="capturarSecuencia()" aria-label="Capturar secuencia">
                        <i class="bi bi-camera-fill me-2" aria-hidden="true"></i> Capturar Secuencia
                    </button>
                    <button class="btn btn-action btn-lg btn-outline-info rounded-pill px-4 py-2" type="button"
                        onclick="verMetricas()" aria-label="M√©tricas del sistema">
                        <i class="bi bi-bar-chart-line me-2" aria-hidden="true"></i> M√©tricas del sistema
                    </button>

                    <button class="btn btn-action btn-lg btn-outline-info rounded-pill px-4 py-2" type="button"
                        onclick="verHistorial()" aria-label="Ver historial">
                        <i class="bi bi-folder2-open me-2" aria-hidden="true"></i> Ver Historial
                    </button>
                </div>
            </section>

            <!-- === CAPTURADORA MEJORADA === -->
            <section class="text-center mb-5">
                <section class="capture-wrapper" id="captureWrapper" aria-label="Capturadora de video">
                    <div class="capture-header d-flex align-items-center justify-content-between">
                        <div class="title fw-semibold">
                            <i class="bi bi-camera-video me-2"></i> Capturadora LSE
                        </div>
                        <div class="indicators d-flex align-items-center gap-2">
                            <span class="badge rounded-pill bg-light text-dark" id="indicadorResolucion">‚Äî</span>
                            <span class="badge rounded-pill bg-success-subtle text-success-emphasis d-none"
                                id="indicadorGrabando">
                                <span class="dot me-1"></span> Grabando
                            </span>
                        </div>
                    </div>

                    <div class="capture-stage position-relative" id="captureStage" style="aspect-ratio:16/9;">
                        <video id="videoFrontend" class="video-viewer w-100 h-100 object-fit-cover" autoplay muted
                            playsinline aria-label="Vista previa de c√°mara para captura de gestos"></video>
                        <canvas id="overlay" class="position-absolute top-0 start-0 w-100 h-100"></canvas>

                        <!-- HUD -->
                        <div class="capture-hud top-left" id="hudTopLeft">
                            <i class="bi bi-speedometer2 me-1"></i><span id="indicadorFps">FPS: ‚Äî</span>
                        </div>

                        <!-- Bot√≥n Pantalla Completa -->
                        <div class="capture-controls position-absolute start-50 translate-middle-x"
                            style="bottom:.65rem;">
                            <button class="btn btn-outline-primary btn-sm rounded-pill px-3" id="btnPantallaCompleta"
                                aria-pressed="false" type="button" title="Pantalla completa">
                                <i class="bi bi-arrows-fullscreen me-1" id="iconFullscreen" aria-hidden="true"></i>
                                Pantalla completa
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Estado -->
                <div id="estadoReconocimiento" class="mt-3 fw-bold text-danger" role="status" aria-live="polite">
                    üî¥ Esperando...
                </div>
            </section>

            <!-- Campo etiqueta + categor√≠a + controles -->
            <section class="mb-4">
                <form class="row g-3 justify-content-center" onsubmit="event.preventDefault();">
                    <div class="col-12 col-md-10 col-lg-8">
                        <!-- Campo de etiqueta -->
                        <div class="input-group px-2 mb-3">
                            <span class="input-group-text bg-primary text-white">
                                <i class="bi bi-chat-square-text" aria-hidden="true"></i>
                                <button type="button" id="clearInputBtn"
                                    class="btn btn-sm btn-outline-light border-0 p-0 ms-2" title="Borrar texto"
                                    aria-label="Borrar texto de la etiqueta">
                                    <i class="bi bi-trash3-fill text-white" aria-hidden="true"></i>
                                </button>
                            </span>
                            <input type="text" id="etiquetaGesto" class="form-control"
                                placeholder="Nombre del gesto a capturar" required maxlength="50" inputmode="text"
                                autocomplete="off" />
                        </div>

                        <!-- Combobox de categor√≠a -->
                        <div class="mb-3">
                            <label for="categoriaSelect" class="form-label fw-bold">
                                <i class="bi bi-tags-fill me-2"></i> Tipo de Gesto
                            </label>
                            <select id="categoriaSelect" name="categoria" class="form-select" required>
                                <option value="" selected disabled>Seleccione una categor√≠a</option>
                                <option value="letra">Letra</option>
                                <option value="numero">N√∫mero</option>
                                <option value="palabra">Palabra</option>
                                <option value="expresion_facial">Expresi√≥n facial</option>
                                <option value="saludo">Saludo</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                    </div>
                </form>
            </section>

            <!-- Botones -->
            <div class="video-controls mt-3 d-flex justify-content-center gap-3 flex-wrap">
                <button id="startBtn" type="button" class="btn btn-primary btn-sm rounded-pill px-3 shadow-sm">
                    <i class="bi bi-play-fill me-1"></i> Iniciar
                </button>

                <button id="stopBtn" type="button" class="btn btn-danger btn-sm rounded-pill px-3 shadow-sm">
                    <i class="bi bi-stop-fill me-1"></i> Detener
                </button>

                <div class="btn-group shadow-sm">
                    <button id="downloadBtn" type="button"
                        class="btn btn-success btn-sm rounded-pill px-3 dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="bi bi-download me-1"></i> Descargar
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow">
                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="#" id="downloadCsvOption">
                                <i class="bi bi-file-earmark-spreadsheet text-success me-2"></i> CSV
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="#" id="downloadJsonOption">
                                <i class="bi bi-file-earmark-code text-warning me-2"></i> JSON
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-4 shadow-top mt-auto">
        <div class="container">
            <div class="mb-3">
                <span class="d-inline-block mx-2">
                    <i class="bi bi-envelope-fill me-1"></i> soporte.aplicaciones@ug.edu.ec
                </span>
            </div>
            <div class="mb-3">
                <span class="d-block">
                    <i class="bi bi-person-fill me-1"></i> Realizado por: <strong>Peter Avil√©s
                        Alarc√≥n</strong> y <strong>Yazmin Pinela Vargas</strong>
                </span>
                <span class="d-block"><i class="bi bi-mortarboard-fill me-1"></i> Carrera: Sistemas de
                    Informaci√≥n</span>
                <span class="d-block"><i class="bi bi-building me-1"></i> Facultad: Ingenier√≠a Industrial</span>
                <span class="d-block"><i class="bi bi-geo-alt-fill me-1"></i> Ubicaci√≥n: Av. Las Aguas, Guayaquil
                    090501</span>
                <span class="d-block"><i class="bi bi-telephone-forward-fill me-1"></i> Tel√©fono: (04) 227-7309</span>
            </div>
            <p class="mb-0">¬© 2025 Universidad de Guayaquil | Proyecto de Tesis</p>
        </div>
    </footer>

    <!-- Modal Historial -->
    <div class="modal fade" id="modalHistorial" tabindex="-1" aria-labelledby="modalHistorialLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalHistorialLabel">
                        <i class="bi bi-folder2-open me-2"></i> Secuencias
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body p-0" style="min-height:70vh;">
                    <iframe id="iframeHistorial" src="" frameborder="0"
                        style="width:100%; height:100%; min-height:70vh;"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal M√©tricas -->
    <div class="modal fade" id="modalMetricas" tabindex="-1" aria-labelledby="modalMetricasLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title d-flex align-items-center gap-2" id="modalMetricasLabel">
                        <i class="bi bi-bar-chart-line"></i>
                        M√©tricas del sistema
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body p-0" style="min-height:70vh;">
                    <iframe id="iframeMetricas" src="" frameborder="0"
                        style="width:100%; height:100%; min-height:70vh;"></iframe>
                </div>
            </div>
        </div>
    </div>


    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>

    <!-- MediaPipe Hands (imprescindible para captura) -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>

    <!-- Tu l√≥gica -->
    <script type="module" src="js/ui.js"></script>
</body>

</html>